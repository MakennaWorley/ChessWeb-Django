{% extends 'chess/base.html' %}
{% load static %}

{% block content %}
    <div class="block-container-list">
        <div class="block-text center">
            <h1>Update Game Results</h1>

            <div id="date-picker">
                <label for="game-date">Select Date:</label>
                <select id="game-date" name="game-date">
                    {% for game in games_by_date %}
                        <option value="{{ game.date_of_match }}">{{ game.date_of_match }}</option>
                    {% endfor %}
                </select>
                <button type="submit" id="dateSubmitBtn">Open Pairings</button>
            </div>

            <div id="gameModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Game Results for <span id="selectedDate"></span></h2>

                    <form id="gameResultsForm" method="POST" action="#">
                        {% csrf_token %}
                        <table>
                            <thead>
                            <tr>
                                <th>Board</th>
                                <th>White Player</th>
                                <th>Result</th>
                                <th>Black Player</th>
                            </tr>
                            </thead>
                            <tbody id="gamesTableBody">
                            {% for game in games %}
                                <tr>
                                    <td>{{ game.board }}</td>
                                    <td>{{ form.white_player }}</td>
                                    <td>{{ form.result }}</td>
                                    <td>{{ form.black_player }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <button type="submit">Submit Results</button>
                    </form>
                </div>
            </div>
        </div>


        <div class="block-text center">
            <h1>Download Ratings Sheet</h1>
            <div>
                <a href="{% url 'download_ratings' %}">
                    <button type="button">Create and Download Current Ratings</button>
                </a>
            </div>
            <br>
            <form method="get" action="{% url 'download_existing_ratings_sheet' %}">
                <label for="file">Choose a pairing sheet:</label>
                <select name="file" id="file">
                    {% for filename in existing_files %}
                        <option value="{{ filename }}">{{ filename }}</option>
                    {% endfor %}
                </select><br>
                <button type="submit">Download Pre-existing Ratings Sheet</button>
            </form>
        </div>
    </div>

    <script>
        const getPlayersUrl = "{% url 'get_players' %}";
        const getGamesUrl = "{% url 'get_games' %}";
        const saveGamesUrl = {% url 'save_games' %};
    </script>
    <script src="{% static 'utils.js' %}"></script>
    <script src="{% static 'input_results.js' %}"></script>
{% endblock %}